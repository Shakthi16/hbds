<html>
<head>
    <title>Happy Birthday Friend</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pacifico&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');
        @import url('https://fonts.googleapis.com/css?family=Lato:300italic');

        /* Rose gold colors */
        :root {
            --rose-gold-light: #f9e4e0;
            --rose-gold-medium: #e7bfb8;
            --rose-gold-dark: #b76e79;
            --rose-gold-accent: #d99a8f;
            --rose-gold-shadow: rgba(183, 110, 121, 0.3);
        }

        .fade-in {
            animation: fadeIn 3s ease-in-out;
        }

        @keyframes fadeIn {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }

        .cake {
            position: relative;
            width: 200px;
            height: 200px;
            margin: 0 auto;
            cursor: pointer;
        }

        .velas {
            background: var(--rose-gold-medium);
            border-radius: 100%;
            position: absolute;
            top: 50%;
            left: 50%;
            margin-left: -10px;
            margin-top: -33.33px;
            width: 10px;
            height: 33.33px;
        }

        .velas:after,
        .velas:before {
            background: var(--rose-gold-accent);
            content: "";
            position: absolute;
            width: 100%;
            height: 4.44px;
        }

        .velas:after {
            top: 25%;
            left: 0;
        }

        .velas:before {
            top: 45%;
            left: 0;
        }

        .fuego {
            border-radius: 100%;
            box-shadow: 0 0 40px 10px rgba(247, 210, 204, 0.6);
            position: absolute;
            top: -12px;
            left: 50%;
            margin-left: -6.67px;
            width: 13.33px;
            height: 25px;
        }

        .fuego:nth-child(1) {
            animation: fuego 2s infinite;
        }

        .fuego:nth-child(2) {
            animation: fuego 1.5s infinite;
        }

        .fuego:nth-child(3) {
            animation: fuego 1s infinite;
        }

        .fuego:nth-child(4) {
            animation: fuego 0.5s infinite;
        }

        .fuego:nth-child(5) {
            animation: fuego 0.2s infinite;
        }

        @keyframes fuego {
            0% {
                background: rgba(247, 210, 204, 0.5);
                transform: translateY(0) scale(1);
            }
            50% {
                background: rgba(183, 110, 121, 0.1);
                transform: translateY(-40px) scale(0);
            }
            100% {
                background: rgba(247, 210, 204, 0.5);
                transform: translateY(0) scale(1);
            }
        }

        .cobertura {
            background: var(--rose-gold-medium);
            border-radius: 100px;
            position: absolute;
            top: 60%;
            left: 50%;
            margin-left: -55.56px;
            margin-top: -20px;
            width: 111.11px;
            height: 25px;
            z-index: 10;
        }

        .cobertura:after,
        .cobertura:before {
            background: var(--rose-gold-medium);
            border-radius: 100px;
            content: "";
            position: absolute;
            width: 10px;
            height: 20px;
        }

        .cobertura:after {
            top: 13.33px;
            right: 28.57px;
        }

        .cobertura:before {
            top: 20px;
            right: 18.18px;
        }

        .bizcocho {
            background: var(--rose-gold-accent);
            position: absolute;
            bottom: 0;
            left: 50%;
            margin-left: -50px;
            width: 100px;
            height: 66.67px;
        }

        .bizcocho:after,
        .bizcocho:before {
            background: var(--rose-gold-light);
            content: "";
            position: absolute;
            width: 100%;
            height: 5px;
        }

        .bizcocho:after {
            top: 20px;
            left: 0;
        }

        .bizcocho:before {
            top: 40px;
            left: 0;
        }

        h1,
        p {
            font-family: 'Lato', sans-serif;
            font-weight: 300;
            font-style: italic;
            text-align: center;
            width: 100%;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        h1 {
            color: var(--rose-gold-dark);
            font-size: 1em;
            margin-top: 136px;
        }

        p {
            color: var(--rose-gold-dark);
            font-size: 0.8em;
            line-height: 2em;
        }

        .cake {
            cursor: pointer;
        }

        .cake .fuego {
            display: block;
        }

        .cake.off .fuego {
            display: none;
        }

        .paper {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scaleY(0);
            width: 90%;
            max-width: 340px;
            max-height: 420px;
            background: var(--rose-gold-light);
            border: 2px solid var(--rose-gold-accent);
            border-radius: 12px;
            padding: 30px 25px 25px 25px;
            box-shadow: 0 0 20px var(--rose-gold-shadow);
            transition: transform 0.5s ease-in-out;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            z-index: 50;
        }

        .paper.open {
            display: block;
            transform: translate(-50%, -50%) scaleY(1);
        }

        .fireworks {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #020202;
            cursor: crosshair;
            z-index: 60;
        }

        .fireworks.open {
            display: block;
        }

        .fireworks h1 {
            position: absolute;
            top: 20%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: var(--rose-gold-dark);
            font-family: "Source Sans Pro";
            font-size: 1.5em;
            font-weight: 900;
            -webkit-user-select: none;
            user-select: none;
            text-align: center;
        }

        canvas {
            display: block;
        }

        .heart-container {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .arrow {
            position: absolute;
            left: -50px;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% {
                transform: translateX(0);
            }
            50% {
                transform: translateX(-10px);
            }
        }

        /* Adjust heading margin to prevent clipping */
        .letter h1 {
            margin-top: 0;
            margin-bottom: 1rem;
            color: var(--rose-gold-dark);
        }

        .letter p {
            color: var(--rose-gold-dark);
        }

        /* Scrollbar styling for paper */
        .paper::-webkit-scrollbar {
            width: 8px;
        }

        .paper::-webkit-scrollbar-track {
            background: var(--rose-gold-light);
            border-radius: 10px;
        }

        .paper::-webkit-scrollbar-thumb {
            background: var(--rose-gold-accent);
            border-radius: 10px;
        }

        /* For Firefox */
        .paper {
            scrollbar-width: thin;
            scrollbar-color: var(--rose-gold-accent) var(--rose-gold-light);
        }

        /* Cursor pointer for handshake icon */
        .handshake-icon {
            cursor: pointer;
            color: var(--rose-gold-dark);
            transition: color 0.3s ease;
        }
        .handshake-icon:hover {
            color: var(--rose-gold-accent);
        }
    </style>
</head>
<body class="bg-gradient-to-b from-[#f9e4e0] to-[#e7bfb8] flex items-center justify-center min-h-screen px-4">
    <div class="text-center fade-in w-full max-w-md">
        <div class="cake" onclick="blowCandles()" role="button" tabindex="0" aria-label="Birthday cake, click to blow candles">
            <div class="velas" aria-hidden="true">
                <div class="fuego"></div>
                <div class="fuego"></div>
                <div class="fuego"></div>
                <div class="fuego"></div>
                <div class="fuego"></div>
            </div>
            <div class="cobertura"></div>
            <div class="bizcocho"></div>
            <h1>Happy Birthday!</h1>
            <p style="color:var(--rose-gold-dark); font-weight: 600;">Friend</p>
        </div>
        <p class="text-lg font-roboto text-rose-gold-dark mt-4" id="wish-text">Pray for a wish and touch the candle to blow it out!</p>
    </div>

    <div class="paper" id="paper" role="region" aria-label="Birthday letter" tabindex="0">
        <div class="letter" id="letter">
            <h1 class="text-4xl font-pacifico mb-4">Happy Birthday Friend!</h1>
            <p class="text-lg font-roboto mb-4 leading-relaxed">
                Thanks for being my friend and a good listener. I could say this confidently: I am blessed to have a friend like you who says "enanalu pathukla". I knew I would say what I should only look after but deep down I felt okay if something goes wrong I could go and tell a person who never judges me but instead says "next time pathuklam". There are more to thank you about but since this is your birthday wish, I wish you a great life ahead and a happy happiest birthday you ever had. Wish we could stay friends forever and whatever you wish will definitely happen soon because you have gone through many struggles. Hereafter your life will only be filled and turned into a beautiful garden of flowers. I mean that much happiness... stay stronger and happier than you have ever lived before. If something happens, don't ever think twice, call me anytime. Even if I am in a situation where I could not pick, I would definitely try to come and pick your call. Speak and so my friend, happy birthday like it's your 21st, right? Happy 21!
            </p>
            <p class="text-lg font-roboto">By,</p>
            <p class="text-lg font-roboto mb-6 font-semibold">Your all time friend</p>
            <div class="heart-container mt-6">
                <i class="fas fa-handshake handshake-icon text-3xl" onclick="showFireworks()" aria-label="Handshake icon to celebrate birthday" role="button" tabindex="0"></i>
                <div class="arrow" aria-hidden="true">
                    <i class="fas fa-arrow-right text-rose-gold-dark text-2xl"></i>
                </div>
            </div>
            <p class="text-lg font-roboto mt-4">Touch the handshake after praying for something!</p>
        </div>
    </div>

    <div class="fireworks" id="fireworks" role="alert" aria-live="assertive">
        <h1>Everything happens as you wish. Happy Happy Birthday Friend!</h1>
        <canvas id="birthday"></canvas>
    </div>

    <script>
        function blowCandles() {
            document.querySelector('.cake').style.display = 'none';
            document.getElementById('wish-text').style.display = 'none';
            setTimeout(() => {
                const paper = document.getElementById('paper');
                paper.classList.add('open');
                document.getElementById('letter').classList.add('open');
                // Focus the paper for accessibility and to enable scrolling with keyboard
                paper.focus();
            }, 500);
        }

        function showFireworks() {
            document.getElementById('paper').style.display = 'none';
            document.getElementById('fireworks').classList.add('open');
            startFireworks();
        }

        function startFireworks() {
            const PI2 = Math.PI * 2;
            const random = (min, max) => Math.random() * (max - min + 1) + min | 0;
            const timestamp = _ => new Date().getTime();

            class Birthday {
                constructor() {
                    this.resize();
                    this.fireworks = [];
                    this.counter = 0;
                }

                resize() {
                    this.width = canvas.width = window.innerWidth;
                    let center = this.width / 2 | 0;
                    this.spawnA = center - center / 4 | 0;
                    this.spawnB = center + center / 4 | 0;
                    this.height = canvas.height = window.innerHeight;
                    this.spawnC = this.height * .1;
                    this.spawnD = this.height * .5;
                }

                onClick(evt) {
                    let x = evt.clientX || evt.touches && evt.touches[0].pageX;
                    let y = evt.clientY || evt.touches[0].pageY;
                    let count = random(3, 5);
                    for (let i = 0; i < count; i++) this.fireworks.push(new Firework(
                        random(this.spawnA, this.spawnB),
                        this.height,
                        x,
                        y,
                        random(0, 260),
                        random(30, 110)));
                    this.counter = -1;
                }

                update(delta) {
                    ctx.globalCompositeOperation = 'hard-light';
                    ctx.fillStyle = `rgba(20,20,20,${ 7 * delta })`;
                    ctx.fillRect(0, 0, this.width, this.height);
                    ctx.globalCompositeOperation = 'lighter';
                    for (let firework of this.fireworks) firework.update(delta);
                    this.counter += delta * 3;
                    if (this.counter >= 1) {
                        this.fireworks.push(new Firework(
                            random(this.spawnA, this.spawnB),
                            this.height,
                            random(0, this.width),
                            random(this.spawnC, this.spawnD),
                            random(0, 360),
                            random(30, 110)));
                        this.counter = 0;
                    }
                    if (this.fireworks.length > 1000) this.fireworks = this.fireworks.filter(firework => !firework.dead);
                }
            }

            class Firework {
                constructor(x, y, targetX, targetY, shade, offsprings) {
                    this.dead = false;
                    this.offsprings = offsprings;
                    this.x = x;
                    this.y = y;
                    this.targetX = targetX;
                    this.targetY = targetY;
                    this.shade = shade;
                    this.history = [];
                }

                update(delta) {
                    if (this.dead) return;
                    let xDiff = this.targetX - this.x;
                    let yDiff = this.targetY - this.y;
                    if (Math.abs(xDiff) > 3 || Math.abs(yDiff) > 3) {
                        this.x += xDiff * 2 * delta;
                        this.y += yDiff * 2 * delta;
                        this.history.push({ x: this.x, y: this.y });
                        if (this.history.length > 20) this.history.shift();
                    } else {
                        if (this.offsprings && !this.madeChilds) {
                            let babies = this.offsprings / 2;
                            for (let i = 0; i < babies; i++) {
                                let targetX = this.x + this.offsprings * Math.cos(PI2 * i / babies) | 0;
                                let targetY = this.y + this.offsprings * Math.sin(PI2 * i / babies) | 0;
                                birthday.fireworks.push(new Firework(this.x, this.y, targetX, targetY, this.shade, 0));
                            }
                        }
                        this.madeChilds = true;
                        this.history.shift();
                    }
                    if (this.history.length === 0) this.dead = true;
                    else if (this.offsprings) {
                        for (let i = 0; this.history.length > i; i++) {
                            let point = this.history[i];
                            ctx.beginPath();
                            ctx.fillStyle = 'hsl(' + this.shade + ',100%,' + i + '%)';
                            ctx.arc(point.x, point.y, 1, 0, PI2, false);
                            ctx.fill();
                        }
                    } else {
                        ctx.beginPath();
                        ctx.fillStyle = 'hsl(' + this.shade + ',100%,50%)';
                        ctx.arc(this.x, this.y, 1, 0, PI2, false);
                        ctx.fill();
                    }
                }
            }

            let canvas = document.getElementById('birthday');
            let ctx = canvas.getContext('2d');
            let then = timestamp();
            let birthday = new Birthday();
            window.onresize = () => birthday.resize();
            document.onclick = evt => birthday.onClick(evt);
            document.ontouchstart = evt => birthday.onClick(evt);

            (function loop() {
                requestAnimationFrame(loop);
                let now = timestamp();
                let delta = now - then;
                then = now;
                birthday.update(delta / 1000);
            })();
        }
    </script>
</body>
</html>
